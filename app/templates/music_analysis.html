{% extends "base.html" %}

{% block content %}
<div class="main-content-container analysis-container">
    <!-- Header -->
    <header class="mb-20">
        <div class="inline-flex items-center gap-4 mb-6">
            <span class="text-[10px] tracking-[0.4em] uppercase opacity-40">System Node: Analysis</span>
            <div class="w-12 h-[1px] bg-white/20"></div>
        </div>
        <h2 class="text-4xl md:text-5xl font-bold serif-font leading-tight mb-4">음악 감정 분석_</h2>
    </header>

    <div class="space-y-12">
        <!-- Input Section -->
        <section class="pixel-card p-6 md:p-12">
            <div class="max-w-2xl mx-auto">
                <h3 class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 text-center">Enter_YouTube_URL</h3>
                <div class="flex flex-col md:flex-row gap-4">
                    <input type="url" id="youtubeUrl" placeholder="https://www.youtube.com/watch?v=..." 
                           class="flex-1 bg-black border-2 border-[#222] p-4 text-sm focus:border-white outline-none font-pixel">
                    <button class="btn-pixel md:px-8" onclick="analyzeMusic()">Analyze</button>
                </div>
                <p class="text-[10px] mt-4 opacity-30 text-center uppercase tracking-widest">Supports YouTube Video or Music Links</p>
            </div>
        </section>

        <!-- Loading / Progress -->
        <section id="loadingSection" class="hidden py-20 text-center">
            <div class="max-w-xl mx-auto">
                <h3 class="text-xl font-bold serif-font mb-8 uppercase tracking-widest animate-pulse">Analyzing_Frequencies</h3>
                <div class="progress-container mb-4">
                    <div id="progressBar" class="progress-fill" style="width: 0%"></div>
                </div>
                <p id="statusText" class="text-[10px] opacity-40 uppercase tracking-widest">Connecting to system node...</p>
            </div>
        </section>

        <!-- Results Section -->
        <section id="resultSection" class="hidden space-y-12">
            <!-- Summary Card -->
            <div class="pixel-card p-12">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                    <div id="videoInfo">
                        <!-- Video Title & Thumbnail will be inserted here -->
                    </div>
                    <div class="flex flex-col justify-center">
                        <h3 class="text-xs uppercase tracking-[0.3em] opacity-40 mb-6">Emotional_Summary</h3>
                        <div id="analysisSummary" class="text-2xl serif-font leading-relaxed">
                            <!-- Summary text will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detailed Analysis Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Sentiment Breakdown -->
                <div class="pixel-card">
                    <h3 class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 pb-2 border-b border-[#111]">Sentiment_Mapping</h3>
                    <div id="sentimentDisplay" class="space-y-6">
                        <!-- Sentiment bars will be inserted here -->
                    </div>
                </div>

                <!-- Keywords/Themes -->
                <div class="pixel-card">
                    <h3 class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 pb-2 border-b border-[#111]">Extracted_Themes</h3>
                    <div id="themeDisplay" class="flex flex-wrap gap-3">
                        <!-- Themes will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Full Commentary -->
            <div class="pixel-card">
                <h3 class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 pb-2 border-b border-[#111]">Deep_Archive_Commentary</h3>
                <div id="fullAnalysis" class="serif-font text-lg leading-loose opacity-70">
                    <!-- Detailed analysis text will be inserted here -->
                </div>
            </div>

            <div class="flex justify-center pt-12">
                <button class="btn-outline text-xs tracking-widest px-12" onclick="resetAnalysis()">NEW_ANALYSIS</button>
            </div>
        </section>
    </div>
</div>

<style>
    /* Analysis Specific Helpers */
    .sentiment-bar-container {
        height: 8px;
        background: #111;
        border: 1px solid #222;
        margin-top: 8px;
    }
    .sentiment-bar-fill {
        height: 100%;
        background: white;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
    }
    .theme-tag {
        padding: 6px 16px;
        border: 1px solid #222;
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
    }
</style>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/music_analysis.js') }}"></script>
{% endblock %}
