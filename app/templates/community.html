{% extends "base.html" %}

{% block title %}ì»¤ë®¤ë‹ˆí‹° - OFF THE COMMUNITY{% endblock %}

{% block extra_css %}
<style>
    .community-header h2 {
        font-size: 3.5rem;
        letter-spacing: -0.05em;
        line-height: 1.1;
        margin-bottom: 1.5rem;
    }
    
    @media (max-width: 768px) {
        .community-header h2 {
            font-size: 2.25rem;
        }
    }
    
    .posts-list {
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }
    
    .post-card {
        padding: 2.5rem;
    }
    
    @media (max-width: 768px) {
        .post-card {
            padding: 1.5rem;
        }
    }
    
    .post-title {
        font-size: 1.75rem;
        font-family: var(--font-serif);
        margin-bottom: 1rem;
        color: var(--pixel-white);
    }
    
    @media (max-width: 768px) {
        .post-title {
            font-size: 1.4rem;
        }
    }
    
    .post-content {
        color: var(--sub-text);
        margin-bottom: 2rem;
        line-height: 1.8;
        font-size: 1.1rem;
        font-family: var(--font-serif);
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .post-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #444;
    }
    
    .empty-state {
        text-align: center;
        padding: 8rem 0;
        border: 2px dashed #222;
    }
</style>
{% endblock %}

{% block content %}
<div class="main-content-container community-container">
    <header class="community-header mb-12">
        <div class="inline-flex items-center gap-4 mb-6">
            <span class="text-[10px] tracking-[0.4em] uppercase opacity-40">System Node: Archive</span>
            <div class="w-12 h-[1px] bg-white/20"></div>
        </div>
        <h2 class="serif-font text-4xl md:text-5xl mb-3">DIARY COMMUNITY_</h2>
        <p class="text-[11px] uppercase tracking-widest opacity-50">
            Sentimental Records
        </p>
    </header>
    
    {% if current_user.is_authenticated %}
    <div class="mb-12">
        <a href="{{ url_for('community_write') }}" class="btn-pixel">
            <span>âœï¸</span>
            <span>ê¸°ë¡í•˜ê¸°</span>
        </a>
    </div>
    {% else %}
    <div class="mb-12">
        <a href="{{ url_for('login') }}" class="btn-outline">
            <span>ğŸ”</span>
            <span>ë¡œê·¸ì¸ í›„ ê¸°ë¡í•˜ê¸°</span>
        </a>
    </div>
    {% endif %}
    
    {% if error %}
    <div class="pixel-card mb-8 border-red-900/50 text-red-200">
        {{ error }}
    </div>
    {% endif %}
    
    {% if posts %}
    <div class="posts-list">
        {% for post in posts %}
        <article class="pixel-card post-card cursor-pointer" onclick="window.location.href='{{ url_for('community_post', post_id=post.id) }}'">
            <div class="post-title">{{ post.title }}</div>
            <div class="post-content">{{ post.content }}</div>
            <div class="post-meta">
                <span>ğŸ‘¤ {{ post.author }}</span>
                <span>{{ post.created_at[:10] if post.created_at else '' }}</span>
            </div>
        </article>
        {% endfor %}
    </div>

    <!-- Pagination -->
    <div class="flex justify-between items-center mt-12 pt-8 border-t-4 border-dashed border-[#111]">
        <div>
            {% if page and page > 1 %}
                <a href="{{ url_for('diary') }}?page={{ page - 1 }}" class="btn-outline text-xs uppercase tracking-widest">
                    PREV
                </a>
            {% endif %}
        </div>
        <div class="text-[10px] opacity-30 uppercase tracking-[0.3em]">
            PAGE {{ page if page else 1 }}
        </div>
        <div>
            {% if has_next %}
                <a href="{{ url_for('diary') }}?page={{ (page if page else 1) + 1 }}" class="btn-outline text-xs uppercase tracking-widest">
                    NEXT
                </a>
            {% endif %}
        </div>
    </div>
    {% else %}
    <div class="empty-state">
        <h3 class="text-xl serif-font mb-4">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</h3>
        <p class="text-sm opacity-40">ì²« ë²ˆì§¸ ì•„ì¹´ì´ë¸Œë¥¼ ìƒì„±í•´ ë³´ì„¸ìš”.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
