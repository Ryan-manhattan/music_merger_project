<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŒì› ì˜ìƒ ë§Œë“¤ê¸° - Music Merger</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <header class="header">
            <h1 class="logo">ğŸµ Music Merger</h1>
            <p class="tagline">ìŒì•… íŒŒì¼ ì´ì–´ë¶™ì´ê¸° ì„œë¹„ìŠ¤</p>
            
            <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="{{ url_for('index') }}" class="nav-link">ğŸµ ìŒì•… ë³‘í•©</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('music_analysis') }}" class="nav-link">ğŸ¤– AI ìŒì•… ìƒì„±</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('music_video') }}" class="nav-link active">ğŸ¬ ìŒì› ì˜ìƒ ë§Œë“¤ê¸°</a>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <main class="main-content">
            <div class="music-video-wrapper">
                <!-- í—¤ë” -->
                <section class="video-header">
                    <div class="video-header-content">
                        <div class="upload-icon">ğŸ¬</div>
                        <h1>ìŒì› ì˜ìƒ ë§Œë“¤ê¸°</h1>
                        <p>ìŒì•… íŒŒì¼ê³¼ ì´ë¯¸ì§€ë¥¼ ì¡°í•©í•˜ì—¬ ë®¤ì§ë¹„ë””ì˜¤ë¥¼ ìƒì„±í•˜ì„¸ìš”</p>
                    </div>
                </section>

                <!-- í†µí•© ì…ë ¥ í¼ -->
                <section class="unified-form" id="unifiedForm">
                    <div class="form-grid">
                        <!-- ìŒì› ì—…ë¡œë“œ ì„¹ì…˜ -->
                        <div class="form-section">
                            <h3>ğŸµ ìŒì› íŒŒì¼</h3>
                            <div class="upload-area" id="audioUploadArea">
                                <div class="upload-icon">ğŸµ</div>
                                <p>ìŒì•… íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”</p>
                                <p class="file-types">MP3, WAV, M4A, FLAC</p>
                                <input type="file" id="audioFileInput" accept=".mp3,.wav,.m4a,.flac" hidden>
                                <div class="btn btn-primary btn-display-only">
                                    íŒŒì¼ ì„ íƒ
                                </div>
                            </div>
                            <div class="file-info" id="audioInfo" style="display: none;">
                                <div class="file-preview">
                                    <span class="file-icon">ğŸµ</span>
                                    <div class="file-details">
                                        <h4 id="audioFileName">íŒŒì¼ëª…</h4>
                                        <p id="audioFileDetails">íŒŒì¼ ì •ë³´</p>
                                    </div>
                                    <button class="btn btn-outline btn-small" onclick="changeAudioFile()">ë³€ê²½</button>
                                </div>
                            </div>
                        </div>

                        <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„¹ì…˜ -->
                        <div class="form-section">
                            <h3>ğŸ–¼ï¸ ë°°ê²½ ì´ë¯¸ì§€</h3>
                            
                            <!-- ì´ë¯¸ì§€ ì„ íƒ íƒ­ -->
                            <div class="tab-selector">
                                <button class="tab-btn active" onclick="switchImageTab('upload')">ì§ì ‘ ì—…ë¡œë“œ</button>
                                <button class="tab-btn" onclick="switchImageTab('ai')">AI ìƒì„±</button>
                            </div>

                            <!-- ì§ì ‘ ì—…ë¡œë“œ -->
                            <div class="tab-content active" id="uploadTab">
                                <div class="upload-area" id="imageUploadArea">
                                    <div class="upload-icon">ğŸ–¼ï¸</div>
                                    <p>ì´ë¯¸ì§€ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”</p>
                                    <p class="file-types">JPG, PNG, BMP, GIF</p>
                                    <input type="file" id="imageFileInput" accept=".jpg,.jpeg,.png,.bmp,.gif" hidden>
                                    <div class="btn btn-primary btn-display-only">
                                        íŒŒì¼ ì„ íƒ
                                    </div>
                                </div>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="applyLogoCheckbox" name="apply_logo">
                                    <span>ë¡œê³  í•©ì„± ì ìš©</span>
                                </label>
                            </div>

                            <!-- AI ìƒì„± -->
                            <div class="tab-content" id="aiTab">
                                <div class="input-group">
                                    <textarea id="imagePrompt" placeholder="ì˜ˆ: ì•„ë¦„ë‹¤ìš´ ì„ì–‘ê³¼ ë°”ë‹¤, ë¯¸ë˜ì ì¸ ë„ì‹œ..." rows="3"></textarea>
                                </div>
                                <div class="form-row">
                                    <select id="imageStyle" class="form-select">
                                        <option value="realistic">ì‚¬ì‹¤ì </option>
                                        <option value="artistic">ì˜ˆìˆ ì </option>
                                        <option value="cartoon">ë§Œí™”í’</option>
                                    </select>
                                    <select id="imageSize" class="form-select">
                                        <option value="1024x1024">ì •ë°©í˜• (1:1)</option>
                                        <option value="1792x1024">ìœ íŠœë¸Œ ì¸ë„¤ì¼ (16:9)</option>
                                        <option value="1024x1792">ìœ íŠœë¸Œ ì‡¼ì¸  (9:16)</option>
                                    </select>
                                </div>
                                <button class="btn btn-success" onclick="generateAIImage()">ğŸ¨ AI ì´ë¯¸ì§€ ìƒì„±</button>
                            </div>

                            <!-- ì„ íƒëœ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                            <div class="image-preview" id="imagePreview" style="display: none;">
                                <img id="previewImage" src="" alt="ë¯¸ë¦¬ë³´ê¸°">
                                <p id="imageDetails">ì´ë¯¸ì§€ ì •ë³´</p>
                                <button class="btn btn-outline btn-small" onclick="changeImage()">ë³€ê²½</button>
                            </div>
                        </div>

                        <!-- ì˜ìƒ ì„¤ì • ì„¹ì…˜ -->
                        <div class="form-section">
                            <h3>ğŸ¬ ì˜ìƒ ì„¤ì •</h3>
                            
                            <div class="input-group">
                                <label for="videoQuality">ì˜ìƒ í’ˆì§ˆ</label>
                                <select id="videoQuality" class="form-select">
                                    <option value="youtube_hd">ìœ íŠœë¸Œ HD (1080p, 30fps)</option>
                                    <option value="youtube_hd_60">ìœ íŠœë¸Œ HD (1080p, 60fps)</option>
                                    <option value="youtube_standard">ìœ íŠœë¸Œ í‘œì¤€ (720p)</option>
                                    <option value="youtube_mobile">ëª¨ë°”ì¼ ìµœì í™” (720p)</option>
                                </select>
                            </div>

                            <div class="options-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="addWatermark">
                                    <span>ì›Œí„°ë§ˆí¬ ì¶”ê°€</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="fadeInOut" checked>
                                    <span>í˜ì´ë“œ ì¸/ì•„ì›ƒ íš¨ê³¼</span>
                                </label>
                            </div>
                        </div>

                        <!-- ë¯¸ë¦¬ë³´ê¸° ë° ìƒì„± -->
                        <div class="form-section summary-section">
                            <h3>ğŸ“‹ ìš”ì•½</h3>
                            <div class="summary-card">
                                <div class="summary-item">
                                    <strong>ìŒì›:</strong> <span id="summaryAudio">ì„ íƒë˜ì§€ ì•ŠìŒ</span>
                                </div>
                                <div class="summary-item">
                                    <strong>ì´ë¯¸ì§€:</strong> <span id="summaryImage">ì„ íƒë˜ì§€ ì•ŠìŒ</span>
                                </div>
                                <div class="summary-item">
                                    <strong>ì˜ˆìƒ ê¸¸ì´:</strong> <span id="summaryDuration">0:00</span>
                                </div>
                            </div>
                            
                            <button class="btn btn-success btn-large btn-generate" id="generateBtn" onclick="generateVideo()" disabled>
                                ğŸ¬ ì˜ìƒ ìƒì„±í•˜ê¸°
                            </button>
                        </div>
                    </div>
                </section>

                <!-- ì˜ìƒ ìƒì„± ì§„í–‰ ìƒí™© -->
                <section class="video-progress" id="videoProgress" style="display: none;">
                    <h2>ğŸ¬ ì˜ìƒ ìƒì„± ì¤‘...</h2>
                    <div class="progress-bar">
                        <div class="progress-fill" id="videoProgressFill"></div>
                    </div>
                    <p class="progress-text" id="videoProgressText">ì˜ìƒ ìƒì„± ì¤€ë¹„ ì¤‘...</p>
                </section>

                <!-- ì™„ì„±ëœ ì˜ìƒ ê²°ê³¼ -->
                <section class="video-result" id="videoResult" style="display: none;">
                    <h2>âœ… ì˜ìƒ ìƒì„± ì™„ë£Œ!</h2>
                    <div class="result-content">
                        <div class="video-player">
                            <video id="resultVideo" controls width="100%" height="400">
                                <source id="videoSource" src="" type="video/mp4">
                                ë¸Œë¼ìš°ì €ê°€ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                            </video>
                        </div>
                        <div class="result-info">
                            <p id="resultDetails">ì˜ìƒ ì •ë³´</p>
                            <div class="result-actions">
                                <button class="btn btn-primary" id="downloadVideoBtn">
                                    ğŸ“¥ ì˜ìƒ ë‹¤ìš´ë¡œë“œ
                                </button>
                                <button class="btn btn-secondary" onclick="resetVideoCreation()">
                                    ğŸ”„ ìƒˆë¡œ ë§Œë“¤ê¸°
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- í‘¸í„° -->
        <footer class="footer">
            <p>&copy; 2024 Music Merger. All rights reserved.</p>
        </footer>
    </div>

    <!-- ìŠ¤íƒ€ì¼ -->
    <style>
    .music-video-wrapper {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .video-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .video-header-content .upload-icon {
        font-size: 4rem;
        margin-bottom: 20px;
    }

    .unified-form {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin-bottom: 20px;
    }

    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        align-items: start;
    }

    .form-section {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
    }

    .form-section h3 {
        margin-bottom: 20px;
        color: #333;
        font-size: 1.2rem;
    }

    .summary-section {
        grid-column: 1 / -1;
        background: #e8f5e8;
        border: 2px solid #4CAF50;
    }

    .tab-selector {
        display: flex;
        margin-bottom: 20px;
        background: #e9ecef;
        border-radius: 6px;
        padding: 4px;
    }

    .tab-btn {
        flex: 1;
        padding: 8px 16px;
        border: none;
        background: transparent;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .tab-btn.active {
        background: white;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-bottom: 15px;
    }

    .upload-area {
        border: 2px dashed #ddd;
        border-radius: 8px;
        padding: 30px;
        text-align: center;
        transition: all 0.3s;
        cursor: pointer;
        margin-bottom: 15px;
    }

    .upload-area:hover {
        border-color: #4CAF50;
        background: #f8fff8;
    }

    .upload-area.drag-over {
        border-color: #4CAF50;
        background: #f0fff0;
    }

    .upload-area .upload-icon {
        font-size: 2rem;
        margin-bottom: 10px;
        display: block;
    }

    .upload-area p {
        margin: 5px 0;
        color: #666;
    }

    .file-types {
        font-size: 0.85rem;
        color: #999;
    }

    .file-info {
        margin-top: 15px;
    }

    .file-preview {
        display: flex;
        align-items: center;
        gap: 15px;
        background: white;
        border-radius: 6px;
        padding: 15px;
        border: 1px solid #ddd;
    }

    .file-icon {
        font-size: 1.5rem;
    }

    .file-details {
        flex: 1;
    }

    .file-details h4 {
        margin: 0 0 5px 0;
        color: #333;
        font-size: 0.95rem;
    }

    .file-details p {
        margin: 0;
        color: #666;
        font-size: 0.85rem;
    }

    .image-preview {
        margin-top: 15px;
        text-align: center;
    }

    .image-preview img {
        max-width: 100%;
        max-height: 150px;
        border-radius: 6px;
        margin-bottom: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .options-group {
        margin-top: 20px;
    }

    .btn-generate {
        width: 100%;
        margin-top: 20px;
        font-size: 1.1rem;
        padding: 15px;
    }

    .btn-generate:disabled {
        background: #ccc;
        cursor: not-allowed;
    }

    .image-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-bottom: 30px;
    }

    .option-card {
        border: 1px solid #ddd;
        border-radius: 12px;
        padding: 25px;
        text-align: center;
    }

    .option-card h3 {
        margin-bottom: 20px;
        color: #333;
    }

    .input-group {
        margin-bottom: 20px;
    }

    .input-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
    }

    .input-group textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-family: inherit;
        resize: vertical;
    }

    .generation-options {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 20px;
    }

    .generation-options label {
        display: flex;
        align-items: center;
        gap: 5px;
        cursor: pointer;
    }

    .preview-container {
        display: flex;
        gap: 20px;
        align-items: flex-start;
        margin: 20px 0;
    }

    .preview-container img {
        max-width: 300px;
        max-height: 200px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .preview-info {
        flex: 1;
    }

    .video-settings {
        max-width: 600px;
        margin: 0 auto;
    }

    .settings-group {
        margin-bottom: 30px;
    }

    .settings-group h3 {
        margin-bottom: 15px;
        color: #333;
    }

    .form-select {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
    }

    .checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 10px;
        cursor: pointer;
    }

    .summary-card {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
    }

    .summary-item {
        margin-bottom: 10px;
    }

    .progress-indicator {
        text-align: center;
        padding: 40px;
    }

    .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #4CAF50;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .video-player {
        margin-bottom: 20px;
    }

    .result-actions {
        display: flex;
        gap: 15px;
        justify-content: center;
    }

    .btn-display-only {
        pointer-events: none;
        cursor: default;
        opacity: 0.8;
    }
    
    @media (max-width: 768px) {
        .form-grid {
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .form-row {
            grid-template-columns: 1fr;
        }
        
        .tab-selector {
            flex-direction: column;
            gap: 5px;
        }
        
        .music-video-wrapper {
            padding: 10px;
        }
        
        .unified-form {
            padding: 20px;
        }
        
        .form-section {
            padding: 15px;
        }
    }
    </style>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/music_video.js') }}"></script>
</body>
</html>