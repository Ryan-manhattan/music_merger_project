<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŒì› ì˜ìƒ ë§Œë“¤ê¸° - Music Merger</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <header class="header">
            <h1 class="logo">ğŸµ Music Merger</h1>
            <p class="tagline">ìŒì•… íŒŒì¼ ì´ì–´ë¶™ì´ê¸° ì„œë¹„ìŠ¤</p>
            
            <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="{{ url_for('index') }}" class="nav-link">ğŸµ ìŒì•… ë³‘í•©</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('music_analysis') }}" class="nav-link">ğŸ¤– AI ìŒì•… ìƒì„±</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('music_video') }}" class="nav-link active">ğŸ¬ ìŒì› ì˜ìƒ ë§Œë“¤ê¸°</a>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <main class="main-content">
            <div class="music-video-wrapper">
                <!-- í—¤ë” -->
                <section class="video-header">
                    <div class="video-header-content">
                        <div class="upload-icon">ğŸ¬</div>
                        <h1>ìŒì› ì˜ìƒ ë§Œë“¤ê¸°</h1>
                        <p>ìŒì•… íŒŒì¼ê³¼ ì´ë¯¸ì§€ë¥¼ ì¡°í•©í•˜ì—¬ ë®¤ì§ë¹„ë””ì˜¤ë¥¼ ìƒì„±í•˜ì„¸ìš”</p>
                    </div>
                </section>

                <!-- ë‹¨ê³„ë³„ ì§„í–‰ í‘œì‹œ -->
                <section class="progress-steps">
                    <div class="step active" id="step1">
                        <div class="step-number">1</div>
                        <span>ìŒì› ì—…ë¡œë“œ</span>
                    </div>
                    <div class="step" id="step2">
                        <div class="step-number">2</div>
                        <span>ì´ë¯¸ì§€ ì„ íƒ</span>
                    </div>
                    <div class="step" id="step3">
                        <div class="step-number">3</div>
                        <span>ì˜ìƒ ìƒì„±</span>
                    </div>
                </section>

                <!-- 1ë‹¨ê³„: ìŒì› ì—…ë¡œë“œ -->
                <section class="video-step" id="audioStep">
                    <div class="step-content">
                        <h2>ğŸµ ìŒì› íŒŒì¼ ì—…ë¡œë“œ</h2>
                        <div class="upload-area" id="audioUploadArea">
                            <div class="upload-icon">ğŸµ</div>
                            <h3>ìŒì•… íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ì„¸ìš”</h3>
                            <p>MP3, WAV, M4A, FLAC íŒŒì¼ì„ ì§€ì›í•©ë‹ˆë‹¤</p>
                            <input type="file" id="audioFileInput" accept=".mp3,.wav,.m4a,.flac" hidden>
                            <button class="btn btn-primary" onclick="document.getElementById('audioFileInput').click()">
                                íŒŒì¼ ì„ íƒ
                            </button>
                        </div>
                        
                        <!-- ì—…ë¡œë“œëœ ìŒì› ì •ë³´ -->
                        <div class="audio-info" id="audioInfo" style="display: none;">
                            <div class="file-card">
                                <div class="file-header">
                                    <span class="file-icon">ğŸµ</span>
                                    <div class="file-details">
                                        <h4 id="audioFileName">íŒŒì¼ëª…</h4>
                                        <p id="audioFileDetails">íŒŒì¼ ì •ë³´</p>
                                    </div>
                                    <button class="btn btn-outline btn-small" onclick="changeAudioFile()">ë‹¤ë¥¸ íŒŒì¼ ì„ íƒ</button>
                                </div>
                            </div>
                            <button class="btn btn-success btn-large" onclick="proceedToImageStep()">
                                ë‹¤ìŒ ë‹¨ê³„ â†’
                            </button>
                        </div>
                    </div>
                </section>

                <!-- 2ë‹¨ê³„: ì´ë¯¸ì§€ ì„ íƒ -->
                <section class="video-step" id="imageStep" style="display: none;">
                    <div class="step-content">
                        <h2>ğŸ–¼ï¸ ë°°ê²½ ì´ë¯¸ì§€ ì„ íƒ</h2>
                        
                        <!-- ì´ë¯¸ì§€ ì„ íƒ ì˜µì…˜ -->
                        <div class="image-options">
                            <!-- ì§ì ‘ ì—…ë¡œë“œ -->
                            <div class="option-card">
                                <h3>ğŸ“ ì´ë¯¸ì§€ ì§ì ‘ ì—…ë¡œë“œ</h3>
                                <div class="upload-area" id="imageUploadArea">
                                    <div class="upload-icon">ğŸ–¼ï¸</div>
                                    <p>JPG, PNG, BMP íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                                    <input type="file" id="imageFileInput" accept=".jpg,.jpeg,.png,.bmp,.gif" hidden>
                                    <label class="checkbox-label" style="margin-top: 10px;">
                                        <input type="checkbox" id="applyLogoCheckbox" name="apply_logo">
                                        <span>ë¡œê³  í•©ì„± ì ìš© (Music Merger ë¡œê³ )</span>
                                    </label>
                                    <button class="btn btn-primary" onclick="document.getElementById('imageFileInput').click()">
                                        ì´ë¯¸ì§€ ì„ íƒ
                                    </button>
                                </div>
                            </div>

                            <!-- AI ìë™ ìƒì„± -->
                            <div class="option-card">
                                <h3>ğŸ¤– AIë¡œ ì´ë¯¸ì§€ ìë™ ìƒì„±</h3>
                                <div class="ai-generation">
                                    <div class="input-group">
                                        <label for="imagePrompt">ì´ë¯¸ì§€ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”:</label>
                                        <textarea id="imagePrompt" placeholder="ì˜ˆ: ì•„ë¦„ë‹¤ìš´ ì„ì–‘ê³¼ ë°”ë‹¤, ë¯¸ë˜ì ì¸ ë„ì‹œ í’ê²½, ê½ƒë°­ê³¼ ë‚˜ë¹„..." rows="3"></textarea>
                                    </div>
                                    <div class="generation-options">
                                        <label>
                                            <input type="radio" name="imageStyle" value="realistic" checked>
                                            <span>ì‚¬ì‹¤ì </span>
                                        </label>
                                        <label>
                                            <input type="radio" name="imageStyle" value="artistic">
                                            <span>ì˜ˆìˆ ì </span>
                                        </label>
                                        <label>
                                            <input type="radio" name="imageStyle" value="cartoon">
                                            <span>ë§Œí™”í’</span>
                                        </label>
                                    </div>
                                    <div class="input-group">
                                        <label for="imageQuality">í’ˆì§ˆ:</label>
                                        <select id="imageQuality" class="form-select">
                                            <option value="standard">Standard (í‘œì¤€)</option>
                                            <option value="hd">HD (ê³ í™”ì§ˆ)</option>
                                        </select>
                                    </div>
                                    <div class="input-group">
                                        <label for="imageSize">í¬ê¸°:</label>
                                        <select id="imageSize" class="form-select">
                                            <option value="1024x1024">ì •ë°©í˜• (1:1)</option>
                                            <option value="1792x1024">ìœ íŠœë¸Œ ì¸ë„¤ì¼ (16:9)</option>
                                            <option value="1024x1792">ìœ íŠœë¸Œ ì‡¼ì¸  (9:16)</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-success" onclick="generateAIImage()">
                                        ğŸ¨ AI ì´ë¯¸ì§€ ìƒì„±
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- ì„ íƒëœ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                        <div class="image-preview" id="imagePreview" style="display: none;">
                            <h3>ì„ íƒëœ ì´ë¯¸ì§€</h3>
                            <div class="preview-container">
                                <img id="previewImage" src="" alt="ë¯¸ë¦¬ë³´ê¸°">
                                <div class="preview-info">
                                    <p id="imageDetails">ì´ë¯¸ì§€ ì •ë³´</p>
                                    <button class="btn btn-outline" onclick="changeImage()">ë‹¤ë¥¸ ì´ë¯¸ì§€ ì„ íƒ</button>
                                </div>
                            </div>
                            <button class="btn btn-success btn-large" onclick="proceedToVideoStep()">
                                ë‹¤ìŒ ë‹¨ê³„ â†’
                            </button>
                        </div>

                        <!-- AI ìƒì„± ì§„í–‰ ìƒí™© -->
                        <div class="ai-progress" id="aiProgress" style="display: none;">
                            <div class="progress-indicator">
                                <div class="spinner"></div>
                                <p>AIê°€ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 3ë‹¨ê³„: ì˜ìƒ ìƒì„± -->
                <section class="video-step" id="videoStep" style="display: none;">
                    <div class="step-content">
                        <h2>ğŸ¬ ì˜ìƒ ìƒì„± ì„¤ì •</h2>
                        
                        <div class="video-settings">
                            <div class="settings-group">
                                <h3>ì˜ìƒ í’ˆì§ˆ ì„¤ì •</h3>
                                <select id="videoQuality" class="form-select">
                                    <option value="youtube_hd">ìœ íŠœë¸Œ HD (1080p, 30fps)</option>
                                    <option value="youtube_hd_60">ìœ íŠœë¸Œ HD (1080p, 60fps)</option>
                                    <option value="youtube_standard">ìœ íŠœë¸Œ í‘œì¤€ (720p)</option>
                                    <option value="youtube_mobile">ëª¨ë°”ì¼ ìµœì í™” (720p)</option>
                                </select>
                            </div>

                            <div class="settings-group">
                                <h3>ì¶”ê°€ ì˜µì…˜</h3>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="addWatermark">
                                    <span>ì›Œí„°ë§ˆí¬ ì¶”ê°€</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" id="fadeInOut" checked>
                                    <span>í˜ì´ë“œ ì¸/ì•„ì›ƒ íš¨ê³¼</span>
                                </label>
                            </div>

                            <!-- ë¯¸ë¦¬ë³´ê¸° -->
                            <div class="preview-summary">
                                <h3>ìƒì„±ë  ì˜ìƒ ë¯¸ë¦¬ë³´ê¸°</h3>
                                <div class="summary-card">
                                    <div class="summary-item">
                                        <strong>ìŒì›:</strong> <span id="summaryAudio">ì„ íƒëœ ìŒì›</span>
                                    </div>
                                    <div class="summary-item">
                                        <strong>ì´ë¯¸ì§€:</strong> <span id="summaryImage">ì„ íƒëœ ì´ë¯¸ì§€</span>
                                    </div>
                                    <div class="summary-item">
                                        <strong>ì˜ˆìƒ ê¸¸ì´:</strong> <span id="summaryDuration">0:00</span>
                                    </div>
                                </div>
                            </div>

                            <button class="btn btn-success btn-large" onclick="startVideoGeneration()">
                                ğŸ¬ ì˜ìƒ ìƒì„± ì‹œì‘
                            </button>
                        </div>
                    </div>
                </section>

                <!-- ì˜ìƒ ìƒì„± ì§„í–‰ ìƒí™© -->
                <section class="video-progress" id="videoProgress" style="display: none;">
                    <h2>ğŸ¬ ì˜ìƒ ìƒì„± ì¤‘...</h2>
                    <div class="progress-bar">
                        <div class="progress-fill" id="videoProgressFill"></div>
                    </div>
                    <p class="progress-text" id="videoProgressText">ì˜ìƒ ìƒì„± ì¤€ë¹„ ì¤‘...</p>
                </section>

                <!-- ì™„ì„±ëœ ì˜ìƒ ê²°ê³¼ -->
                <section class="video-result" id="videoResult" style="display: none;">
                    <h2>âœ… ì˜ìƒ ìƒì„± ì™„ë£Œ!</h2>
                    <div class="result-content">
                        <div class="video-player">
                            <video id="resultVideo" controls width="100%" height="400">
                                <source id="videoSource" src="" type="video/mp4">
                                ë¸Œë¼ìš°ì €ê°€ ë¹„ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                            </video>
                        </div>
                        <div class="result-info">
                            <p id="resultDetails">ì˜ìƒ ì •ë³´</p>
                            <div class="result-actions">
                                <button class="btn btn-primary" id="downloadVideoBtn">
                                    ğŸ“¥ ì˜ìƒ ë‹¤ìš´ë¡œë“œ
                                </button>
                                <button class="btn btn-secondary" onclick="resetVideoCreation()">
                                    ğŸ”„ ìƒˆë¡œ ë§Œë“¤ê¸°
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- í‘¸í„° -->
        <footer class="footer">
            <p>&copy; 2024 Music Merger. All rights reserved.</p>
        </footer>
    </div>

    <!-- ìŠ¤íƒ€ì¼ -->
    <style>
    .music-video-wrapper {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }

    .video-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .video-header-content .upload-icon {
        font-size: 4rem;
        margin-bottom: 20px;
    }

    .progress-steps {
        display: flex;
        justify-content: center;
        margin-bottom: 40px;
        position: relative;
    }

    .progress-steps::before {
        content: '';
        position: absolute;
        top: 20px;
        left: 25%;
        right: 25%;
        height: 2px;
        background: #e0e0e0;
        z-index: 1;
    }

    .step {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        z-index: 2;
        background: white;
        padding: 0 20px;
    }

    .step-number {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-bottom: 10px;
        transition: all 0.3s;
    }

    .step.active .step-number {
        background: #4CAF50;
        color: white;
    }

    .step.completed .step-number {
        background: #2196F3;
        color: white;
    }

    .video-step {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin-bottom: 20px;
    }

    .upload-area {
        border: 2px dashed #ddd;
        border-radius: 12px;
        padding: 40px;
        text-align: center;
        transition: all 0.3s;
        cursor: pointer;
    }

    .upload-area:hover {
        border-color: #4CAF50;
        background: #f8fff8;
    }

    .upload-area.drag-over {
        border-color: #4CAF50;
        background: #f0fff0;
    }

    .file-card {
        background: #f5f5f5;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
    }

    .file-header {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .file-icon {
        font-size: 2rem;
    }

    .file-details h4 {
        margin: 0;
        color: #333;
    }

    .file-details p {
        margin: 5px 0 0 0;
        color: #666;
        font-size: 0.9rem;
    }

    .image-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-bottom: 30px;
    }

    .option-card {
        border: 1px solid #ddd;
        border-radius: 12px;
        padding: 25px;
        text-align: center;
    }

    .option-card h3 {
        margin-bottom: 20px;
        color: #333;
    }

    .input-group {
        margin-bottom: 20px;
    }

    .input-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
    }

    .input-group textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-family: inherit;
        resize: vertical;
    }

    .generation-options {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin-bottom: 20px;
    }

    .generation-options label {
        display: flex;
        align-items: center;
        gap: 5px;
        cursor: pointer;
    }

    .preview-container {
        display: flex;
        gap: 20px;
        align-items: flex-start;
        margin: 20px 0;
    }

    .preview-container img {
        max-width: 300px;
        max-height: 200px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .preview-info {
        flex: 1;
    }

    .video-settings {
        max-width: 600px;
        margin: 0 auto;
    }

    .settings-group {
        margin-bottom: 30px;
    }

    .settings-group h3 {
        margin-bottom: 15px;
        color: #333;
    }

    .form-select {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
    }

    .checkbox-label {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 10px;
        cursor: pointer;
    }

    .summary-card {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
    }

    .summary-item {
        margin-bottom: 10px;
    }

    .progress-indicator {
        text-align: center;
        padding: 40px;
    }

    .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #4CAF50;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .video-player {
        margin-bottom: 20px;
    }

    .result-actions {
        display: flex;
        gap: 15px;
        justify-content: center;
    }

    @media (max-width: 768px) {
        .image-options {
            grid-template-columns: 1fr;
        }
        
        .preview-container {
            flex-direction: column;
        }
        
        .progress-steps {
            flex-wrap: wrap;
            gap: 20px;
        }
    }
    </style>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/music_video.js') }}"></script>
</body>
</html>