{% extends "base.html" %}

{% block title %}실시간 차트 - OFF THE COMMUNITY{% endblock %}

{% block extra_css %}
<style>
    .charts-container {
        max-width: 72rem;
        margin: 0 auto;
        padding: 4rem 1.5rem 8rem;
    }
    
    .charts-header {
        margin-bottom: 4rem;
    }
    
    .charts-header h1 {
        font-size: 3rem;
        letter-spacing: -0.05em;
        line-height: 1.1;
        margin-bottom: 1rem;
    }
    
    .charts-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 4rem;
    }
    
    .stat-card {
        padding: 1.5rem;
        text-align: center;
    }
    
    .stat-value {
        font-size: 1.75rem;
        font-weight: bold;
        color: var(--pixel-white);
        margin-bottom: 0.5rem;
    }
    
    .stat-label {
        font-size: 0.7rem;
        opacity: 0.4;
        text-transform: uppercase;
        letter-spacing: 0.2em;
    }
    
    .chart-filters {
        margin-bottom: 3rem;
        padding: 2rem;
        background: var(--bg-black);
    }
    
    .filter-group {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
        margin-bottom: 1.5rem;
    }
    
    .filter-group:last-child { margin-bottom: 0; }
    
    .filter-group label {
        font-size: 10px;
        opacity: 0.4;
        text-transform: uppercase;
        letter-spacing: 0.2em;
        min-width: 100px;
    }

    .track-item {
        margin-bottom: 1rem;
    }
    
    .track-rank {
        font-size: 1.25rem;
        font-weight: bold;
        min-width: 40px;
    }
    
    .track-title {
        font-family: var(--font-serif);
        font-weight: bold;
    }
    
    .track-artist {
        font-size: 0.85rem;
        opacity: 0.5;
    }

    .service-badge {
        padding: 2px 8px;
        font-size: 9px;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        border: 1px solid #333;
    }
</style>
{% endblock %}

{% block content %}
<div class="main-content-container charts-container">
    <div class="charts-header">
        <div class="inline-flex items-center gap-4 mb-6">
            <span class="text-[10px] tracking-[0.4em] uppercase opacity-40">System Node: Charts</span>
            <div class="w-12 h-[1px] bg-white/20"></div>
        </div>
        <h1 class="text-4xl md:text-5xl serif-font leading-tight">실시간 음악 차트_</h1>
        <p class="text-sm opacity-50 italic serif-font">Spotify와 국내 주요 음원사의 데이터를 실시간으로 동기화합니다.</p>
        
        <div class="flex flex-col md:flex-row gap-4 mt-12">
            <button id="refreshBtn" class="btn-pixel text-xs tracking-widest">Refresh_Data</button>
            <button id="toggleSourceBtn" class="btn-outline text-xs tracking-widest">Switch_Chart</button>
        </div>
    </div>

    <!-- Stats -->
    <div class="charts-stats" id="chartsStats">
        <div class="pixel-card stat-card">
            <div class="stat-value" id="totalTracks">-</div>
            <div class="stat-label">Total_Tracks</div>
        </div>
        <div class="pixel-card stat-card">
            <div class="stat-value" id="koreaCount">-</div>
            <div class="stat-label">Korea_Node</div>
        </div>
        <div class="pixel-card stat-card">
            <div class="stat-value" id="globalCount">-</div>
            <div class="stat-label">Global_Node</div>
        </div>
        <div class="pixel-card stat-card">
            <div class="stat-value" id="lastUpdated">-</div>
            <div class="stat-label">Last_Sync</div>
        </div>
    </div>

    <!-- Filters -->
    <div class="pixel-card chart-filters">
        <div class="filter-group">
            <label>Source_Node</label>
            <button class="btn-outline text-[10px] source-btn active" data-source="melon">Melon</button>
            <button class="btn-outline text-[10px] source-btn" data-source="bugs">Bugs</button>
            <button class="btn-outline text-[10px] source-btn" data-source="genie">Genie</button>
            <button class="btn-outline text-[10px] source-btn" data-source="korea-all">Cross_Platform</button>
        </div>
        <div class="filter-group" id="melonFilters">
            <label>Chart_Type</label>
            <button class="btn-outline text-[10px] melon-type-btn active" data-type="realtime">Realtime</button>
            <button class="btn-outline text-[10px] melon-type-btn" data-type="hot100">Hot_100</button>
        </div>
    </div>

    <!-- Loading -->
    <div id="loadingSpinner" class="hidden py-20 text-center">
        <p class="text-[10px] uppercase tracking-[0.5em] animate-pulse">Syncing_Realtime_Data...</p>
    </div>

    <!-- Error -->
    <div id="errorMessage" class="hidden pixel-card border-red-900/50 text-red-200 mb-8"></div>

    <!-- Chart Grid -->
    <div class="chart-grid" id="chartGrid">
        <div id="melonCharts">
            <div class="pixel-card">
                <h3 id="melonChartTitle" class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 pb-2 border-b border-[#111]">Melon_Realtime_Top_50</h3>
                <div class="track-list space-y-4" id="melonChart"></div>
            </div>
        </div>

        <div id="bugsCharts" class="hidden">
            <div class="pixel-card">
                <h3 id="bugsChartTitle" class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 pb-2 border-b border-[#111]">Bugs_Realtime_Top_50</h3>
                <div class="track-list space-y-4" id="bugsChart"></div>
            </div>
        </div>

        <div id="genieCharts" class="hidden">
            <div class="pixel-card">
                <h3 id="genieChartTitle" class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 pb-2 border-b border-[#111]">Genie_Realtime_Top_50</h3>
                <div class="track-list space-y-4" id="genieChart"></div>
            </div>
        </div>

        <div id="koreaCharts" class="hidden">
            <div class="pixel-card">
                <h3 class="text-xs uppercase tracking-[0.3em] opacity-40 mb-8 pb-2 border-b border-[#111]">Cross_Platform_Hits_Top_20</h3>
                <div class="track-list space-y-4" id="crossPlatformChart"></div>
            </div>
            <div id="serviceCharts" class="mt-8 space-y-8"></div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/charts.js') }}"></script>
{% endblock %}
