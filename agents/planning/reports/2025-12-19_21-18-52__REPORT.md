## 보고 형식 (기획 보고서)

- **보고일시**: 2025-12-19 (금) 21:18:52
- **보고자**: 기획자(Assistant)
- **보고 대상**: 사장님

## 1) 결론 요약 (1~3줄)
- 중심 컨텐츠 범위를 **YouTube + SoundCloud**로 1차 한정하고, 향후 확장을 전제로 한 정책/구조로 기획을 고정했습니다.
- 최종 보고서 초단위 누적 저장, 팀 회의 폴더, 개발자 에이전트 공유 문서/플로우를 `docs/planning/` 아래에 구축했습니다.

## 2) 서비스 목적/컨셉 정리
- **목적**: 특정 컨텐츠를 중심으로, 사용자(개인/그룹)가 자신의 생각과 감정을 기록하는 아카이브.
- **중심 컨텐츠(1차 한정)**: YouTube, SoundCloud
- **확장 원칙**: 추후 플랫폼(Spotify/기사/이미지 등) 확장은 결재 후 추가
- **톤 & 무드**: Pixel / Archive / Sentimental / System Node

## 3) 현재 파악된 현황(팩트)
- **메인(Home)**: `/` = Diary Community(기록 목록)
- **핵심 플로우**: 목록 → 기록하기 → 상세 보기
- **보류(테마 비정합 기능)**: 구현 상태는 유지, 기획 판단에서 우선순위 제외(사장님 지시)

## 4) 이슈/리스크
- 컨텐츠 중심(YouTube/SoundCloud)임을 작성 UX에서 강하게 유도하지 않으면, 기록이 일반 게시글로 흐를 리스크가 있습니다.

## 5) 결정 필요(사장님 결재 요청)
- 없음(금일 지시사항 반영 완료)

## 6) 다음 작업(내가 진행)
- YouTube/SoundCloud를 중심 컨텐츠로 하는 **작성 필드/정책(최소 스키마, 검증 규칙, 카피/프롬프트)** 기획안을 다음 보고서에 제시

## 7) 산출물/링크
- `docs/planning/reports/README.md`
- `docs/planning/meetings/00_MEETING_TEMPLATE.md`
- `docs/planning/dev/00_DEV_AGENT_PLAYBOOK.md`
- `docs/planning/06_COLLAB_FLOW.md`

---

## 10) 개발 진행 현황 업데이트 (2025-12-19 추가 / SSOT: agents/planning)
- **사장님 결재(승인)**: `tracks.metadata(jsonb)` 확장 슬롯 추가 및 적용(옵션 1)
- **실행(Dev)**:
  - Supabase CLI로 원격 DB에 마이그레이션 적용 완료
  - 적용 파일: `supabase/migrations/20251219001000_add_tracks_metadata.sql`
  - 원격 DB 상태: `supabase db push` 결과 “Remote database is up to date”
- **이슈/원인**:
  - 동일 버전(`20251219001000`)의 마이그레이션 파일이 중복 존재하여 `schema_migrations_pkey` 충돌 발생
  - 중복 파일 제거 후 정상화
- **동작 검증(로컬 앱 → 원격 Supabase)**:
  - 기존에 이미 등록된 트랙이라도, `metadata`가 비어있을 때만 **재등록 요청으로 metadata를 보강**하도록 서버 로직 보완
  - 검증 결과: Track Detail의 Track_Data 패널에서 `Raw_Metadata = ON` 확인

## 8) 개발 진행 현황 업데이트 (2025-12-19 추가)
- **사장님 결재/범위 확정(반영)**: “YouTube + SoundCloud 링크 기반 곡 참여형 추가 → 메타데이터 자동 수집 → 곡 상세에서 코멘트(일기처럼) 작성” 플로우로 결정
- **현재 상태(팩트)**:
  - 로컬 서버 기준 `/`는 **Song Archive(곡 목록/추가)**, `/diary`는 **Diary Community(기존 기록)**로 분리 완료
  - Supabase 측에 `tracks` / `track_comments` 테이블이 아직 없어(로그: `PGRST205`), 곡 추가 API가 500으로 실패하는 상태
- **조치(옵션 1 진행)**: Supabase SQL Editor에서 아래 마이그레이션(SQL) 실행으로 테이블 생성 진행
  - 마이그레이션 파일: `supabase/migrations/20251219000000_create_tracks_and_comments.sql`

## 9) Supabase CLI 진행 결과 보고 (2025-12-19 추가)
- **사장님 지시**: “Supabase SQL Editor가 아닌, Supabase CLI로 진행”
- **문제(원인)**: 원격 DB의 마이그레이션 히스토리(20251205~20251208)가 로컬 `supabase/migrations/`에 없어 `supabase db push`가 차단됨
- **조치(무중단/안전 우선)**:
  - 원격 히스토리와 로컬 파일을 맞추기 위해 **no-op placeholder migration 파일**을 로컬에 추가
    - `supabase/migrations/20251205~20251208_remote_placeholder.sql` (9개)
  - `20250101000000` 버전은 원격 히스토리에 없었으나(이미 DB에 posts가 존재하는 환경), 충돌 방지를 위해 **원격 마이그레이션 히스토리만 applied로 repair**
    - 실행: `supabase migration repair --status applied 20250101000000`
  - 이후 `supabase db push`로 **tracks/track_comments 마이그레이션 적용 완료**
- **결과(검증)**:
  - `supabase db push` 성공: `20251219000000_create_tracks_and_comments.sql` 적용됨
  - 로컬 서버에서 API 동작 확인:
    - `POST /api/tracks` → 201 (track_id 발급 확인)
    - `POST /api/tracks/<track_id>/comments` → 201 (comment_id 발급 확인)

